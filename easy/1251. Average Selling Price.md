## 1251. Average Selling Price

**Data:** 11/12/2025  
**Dificuldade:** Easy  
**Tópicos:** SQL, LEFT JOIN, BETWEEN, COALESCE, NULLIF, ROUND  
**Link:** [Average Selling Price - LeetCode](https://leetcode.com/problems/average-selling-price?envType=study-plan-v2&envId=top-sql-50)

### Descrição
Calcular o preço médio de venda para cada produto, considerando os preços vigentes nas datas de venda.

### Solução (SQL Server)
```sql
SELECT 
    p.product_id,
    COALESCE(
        ROUND(SUM(u.units * p.price * 1.0) / NULLIF(SUM(u.units), 0), 2),
        0
    ) AS average_price    
FROM Prices p 
LEFT JOIN UnitsSold u
    ON p.product_id = u.product_id
    AND u.purchase_date BETWEEN p.start_date AND p.end_date
GROUP BY p.product_id;
