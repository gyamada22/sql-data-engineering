# 1795. Rearrange Products Table

**Data:** 31/12/2025  
**Dificuldade:** Easy  
**Tópicos:** SQL, UNION ALL  
**Link:** Rearrange Products Table - LeetCode

## Descrição
Write a solution to **rearrange the Products table** so that each row contains the `product_id`, `store`, and `price`.

Each product may have prices in multiple stores, and rows with `NULL` prices should be ignored.

---

## Solução (SQL Server)

```sql
SELECT
    product_id,
    'store1' AS store,
    store1 AS price
FROM products
WHERE store1 IS NOT NULL

UNION ALL

SELECT
    product_id,
    'store2' AS store,
    store2 AS price
FROM products
WHERE store2 IS NOT NULL

UNION ALL

SELECT
    product_id,
    'store3' AS store,
    store3 AS price
FROM products
WHERE store3 IS NOT NULL;
