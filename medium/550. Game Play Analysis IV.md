# 550. Game Play Analysis IV

**Data:** 19/12/2025  
**Dificuldade:** Easy  
**Tópicos:** SQL, CTE, JOIN, DATEADD, COUNT, ROUND  
**Link:** https://leetcode.com/problems/game-play-analysis-iv/description/?envType=study-plan-v2&envId=top-sql-50

## Descrição
Escreva uma solução para calcular a fração de jogadores que logaram novamente **no dia seguinte** ao seu primeiro login. Retorne o valor arredondado para 2 casas decimais.

## Solução (SQL Server)

```sql
WITH cte1 AS (
    SELECT  
        player_id,
        MIN(event_date) AS day1
    FROM activity
    GROUP BY player_id
)
SELECT 
    ROUND(
        SUM(CASE WHEN a.event_date = DATEADD(day, 1, day1) THEN 1 ELSE 0 END) * 1.0 / 
        NULLIF(COUNT(DISTINCT a.player_id), 0),
        2
    ) AS fraction
FROM cte1 
JOIN activity a 
    ON cte1.player_id = a.player_id;
