# 1193. Monthly Transactions I

**Data:** 18/12/2025  
**Dificuldade:** Medium
**Tópicos:** SQL, GROUP BY, COUNT, SUM, FORMAT  
**Link:** https://leetcode.com/problems/monthly-transactions-i/?envType=study-plan-v2&envId=top-sql-50

## Descrição
Escreva uma solução para gerar estatísticas mensais de transações por país. Para cada mês e país, calcule:
- Número total de transações
- Número de transações aprovadas
- Valor total das transações
- Valor total das transações aprovadas

## Solução (SQL Server)

```sql
SELECT
    FORMAT(trans_date, 'yyyy-MM') AS month,
    country,
    COUNT(*) AS trans_count,
    SUM(CASE WHEN state = 'approved' THEN 1 ELSE 0 END) AS approved_count,
    SUM(amount) AS trans_total_amount,
    SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount
FROM transactions
GROUP BY FORMAT(trans_date, 'yyyy-MM'), country;
