# 570. Managers With at Least 5 Direct Reports

**Data:** 17/12/2025  
**Dificuldade:** Medium  
**Tópicos:** SQL, JOIN, GROUP BY  
**Link:** https://leetcode.com/problems/managers-with-at-least-5-direct-reports/?envType=study-plan-v2&envId=top-sql-50

## Descrição
Escreva uma solução para encontrar os nomes dos gerentes que possuem pelo menos cinco funcionários que se reportam diretamente a eles.

## Solução (SQL Server)

```sql
WITH qwer AS (
    SELECT e.id,
           e.name,
           COUNT(ee.managerid) AS qwe
    FROM employee e
    JOIN employee ee
        ON e.id = ee.managerid
    GROUP BY e.id, e.name
)

SELECT name
FROM qwer
WHERE qwe >= 5;

