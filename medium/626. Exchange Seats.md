# 626. Exchange Seats

**Data:** 22/12/2024  
**Dificuldade:** Medium  
**Tópicos:** SQL, Window Function, Conditional Logic, CASE WHEN, Subquery  
**Link:** https://leetcode.com/problems/exchange-seats/description/?envType=study-plan-v2&envId=top-sql-50

## Descrição
Escreva uma solução para trocar os lugares dos alunos consecutivos.  
Se o número total de alunos for ímpar, o último aluno mantém sua posição.  
Cada aluno com id `i` deve trocar de lugar com o aluno com id `i+1` se i for ímpar, ou com id `i-1` se i for par.

## Solução (SQL Server)

```sql
with qwe as (
    select id,
            student,
            case
                when id % 2 = 1 and id < (select max(id) from seat) then id + 1
                when id % 2 = 0 then id -1
                else id
            end as novo_id
    from seat
)

select novo_id as id,
        student
from qwe
order by novo_id;
