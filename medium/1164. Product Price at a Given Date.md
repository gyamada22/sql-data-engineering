# 1164. Product Price at a Given Date

**Data:** 22/12/2025  
**Dificuldade:** Medium  
**Tópicos:** SQL, Window Functions, ROW_NUMBER, COALESCE, LEFT JOIN  
**Link:** https://leetcode.com/problems/product-price-at-a-given-date/description/?envType=study-plan-v2&envId=top-sql-50

## Descrição
Para cada produto, encontre o **preço mais recente** que foi definido **até uma data específica** (`2019-08-16`).  
Se não houver alteração antes dessa data, o preço padrão é 10.

## Solução (SQL Server)

```sql
WITH qwe AS (
    SELECT product_id,
           change_date,
           new_price,
           ROW_NUMBER() OVER (PARTITION BY product_id ORDER BY change_date DESC) AS asd
    FROM products
    WHERE change_date <= '2019-08-16'
)
SELECT DISTINCT p.product_id,
       COALESCE(qwe.new_price, 10) AS price
FROM products p
LEFT JOIN qwe ON p.product_id = qwe.product_id
              AND qwe.asd = 1
