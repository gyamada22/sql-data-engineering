---Resolu√ßao 8
-- Ex1
SELECT * FROM DimProductSubcategory;
SELECT * FROM DimProduct;
SELECT ProductKey AS Id, ProductName AS Produto, ProductSubcategoryName AS Subcategoria 
FROM DimProduct dp JOIN DimProductSubcategory dps ON dps.ProductSubcategoryKey = dp.ProductSubcategoryKey;

-- Ex2
SELECT * FROM DimProductSubcategory;
SELECT * FROM DimProductCategory;
SELECT ProductCategoryName AS 'Product', ProductSubcategoryName AS 'Subcategoria' 
FROM DimProductSubcategory dps LEFT JOIN DimProductCategory dpc ON dps.ProductCategoryKey = dpc.ProductCategoryKey;

-- Ex3
SELECT * FROM DimStore;
SELECT * FROM DimGeography;
SELECT StoreKey AS ID, StoreName AS 'Nome da loja', EmployeeCount AS 'Numero de funcionarios', ContinentName AS 'Continente', RegionCountryName AS 'Nome do pais' 
FROM DimStore ds LEFT JOIN DimGeography dg ON ds.GeographyKey = dg.GeographyKey;

-- Ex4
SELECT * FROM DimProduct;
SELECT * FROM DimProductSubcategory;
SELECT * FROM DimProductCategory;
SELECT ProductName, ProductCategoryDescription FROM DimProduct dp LEFT JOIN DimProductSubcategory dps ON dp.ProductSubcategoryKey = dps.ProductSubcategoryKey
LEFT JOIN DimProductCategory dpc ON dps.ProductCategoryKey = dpc.ProductCategoryKey;

-- Ex5
SELECT TOP(100) * FROM FactStrategyPlan;
SELECT * FROM DimAccount;
SELECT StrategyPlanKey, DateKey, AccountName, Amount FROM DimAccount JOIN FactStrategyPlan ON DimAccount.AccountKey = FactStrategyPlan.AccountKey;

-- Ex6
SELECT StrategyPlanKey, DateKey, ScenarioName, Amount FROM FactStrategyPlan fcp
JOIN DimScenario da ON da.ScenarioKey = fcp.ScenarioKey;

-- Ex7
SELECT * FROM DimProductSubcategory;
SELECT * FROM DimProduct;
SELECT ProductSubcategoryName, ProductName FROM DimProductSubcategory dps
LEFT JOIN DimProduct dp ON dp.ProductSubcategoryKey = dps.ProductSubcategoryKey
WHERE ProductName IS NULL;

-- Ex8
SELECT * FROM DimProduct;
SELECT * FROM DimChannel;
SELECT TOP(100) * FROM FactSales;
SELECT DISTINCT BrandName, ChannelName FROM DimProduct dp JOIN FactSales fs ON dp.ProductKey = fs.ProductKey
LEFT JOIN DimChannel dc ON dc.ChannelKey = fs.ChannelKey
WHERE BrandName IN ('Contoso','Fabrikam','Litware')
ORDER BY BrandName;

-- Ex9
SELECT TOP(100) * FROM FactOnlineSales;
SELECT TOP(100) * FROM DimPromotion;
SELECT OnlineSalesKey, DateKey, PromotionName, SalesAmount FROM FactOnlineSales fos
LEFT JOIN DimPromotion dp ON dp.PromotionKey = fos.PromotionKey
WHERE PromotionName <> 'No Discount'
ORDER BY DateKey ASC;

-- Ex10
SELECT fs.SalesKey, dc.ChannelName, ds.StoreName, dp.ProductName, SalesAmount FROM FactSales fs
LEFT JOIN DimChannel dc ON fs.ChannelKey = dc.ChannelKey
LEFT JOIN DimStore ds ON ds.StoreKey = fs.StoreKey
LEFT JOIN DimProduct dp ON dp.ProductKey = fs.ProductKey
ORDER BY SalesAmount DESC;
